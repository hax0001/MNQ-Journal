<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MNQ Trader Journal — One Trade. One Masterpiece.</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>MNQ JOURNAL</h1>
      <nav>
        <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
        <button class="tab-btn" data-tab="history">History</button>
        <button class="tab-btn" data-tab="add">Add Trade</button>
        <button class="tab-btn" data-tab="analyses">Analyses</button>
        <button class="tab-btn" data-tab="data">Data</button>
      </nav>
    </header>

    <main>
      <!-- DASHBOARD -->
      <section id="dashboard" class="tab active">
        <div class="split-view">
          <div class="visual-zone">
            <div id="noTradeToday" class="no-trade">No trade logged today. <button id="quickAddBtn">+ Add Trade</button></div>
            <div id="tradeVisual" style="display:none">
              <div class="trade-badge" id="tradeBadge">✅ +$0</div>
              <img id="tradeChart" src="" alt="Trade Chart" />
              <div class="tag" id="tradeTag">—</div>
              <div class="streak" id="streakIndicator">—</div>
            </div>
          </div>
          <div class="data-zone">
            <table id="tradeStats">
              <tr><td>Direction:</td><td id="tradeDirection">—</td></tr>
              <tr><td>Entry:</td><td id="tradeEntry">—</td></tr>
              <tr><td>Exit:</td><td id="tradeExit">—</td></tr>
              <tr><td>P/L:</td><td id="tradePL">—</td></tr>
              <tr><td>R:R:</td><td id="tradeRR">—</td></tr>
              <tr><td>Duration:</td><td id="tradeDuration">—</td></tr>
              <tr><td>Mental:</td><td id="tradeMental">—</td></tr>
            </table>
            <h4>📅 Monthly Calendar</h4>
            <canvas id="calendarHeatmap" height="120"></canvas>
          </div>
        </div>
      </section>

      <!-- HISTORY -->
      <section id="history" class="tab">
        <div class="view-toggle">
          <button id="gridViewBtn" class="active">🖼️ Grid View</button>
          <button id="tableViewBtn">🔢 Table View</button>
        </div>
        <div id="tradeGrid" class="trade-grid"></div>
        <table id="tradeTable" style="display:none">
          <thead>
            <tr><th>Date</th><th>P/L</th><th>Tag</th><th>R:R</th><th>Duration</th><th>Mental</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <!-- ADD TRADE -->
      <section id="add" class="tab">
        <form id="tradeForm">
          <h2>➕ Log Today’s Trade</h2>
          <label>Upload Chart Screenshot (required)</label>
          <input type="file" id="screenshotInput" accept="image/*" required />

          <div id="imagePreview" style="display:none; position:relative; margin:1rem 0;">
            <img id="previewImage" style="max-width:100%; border:1px solid #444; border-radius:8px;" />
            <div style="margin-top:0.5rem; font-size:0.9em; color:#aaa;">(Optional: Use tools to draw later)</div>
          </div>

          <div class="form-row">
            <div>
              <label>Direction</label>
              <div class="toggle" id="directionToggle">
                <button type="button" data-dir="long" class="active">Long</button>
                <button type="button" data-dir="short">Short</button>
              </div>
            </div>
            <div>
              <label>Entry Price</label>
              <input type="number" id="entryPrice" step="1" required />
            </div>
            <div>
              <label>Exit Price</label>
              <input type="number" id="exitPrice" step="1" required />
            </div>
          </div>

          <label>Tag This Setup</label>
          <select id="setupTag">
            <option value="VWAP Bounce">VWAP Bounce</option>
            <option value="Liquidity Grab">Liquidity Grab</option>
            <option value="Gap Fill">Gap Fill</option>
            <option value="Breakout Retest">Breakout Retest</option>
            <option value="Custom">+ Add Custom</option>
          </select>
          <input type="text" id="customTag" placeholder="e.g., ‘News Spike Fade’" style="display:none; margin-top:0.5rem; width:100%; padding:0.5rem; border-radius:4px; background:#222; color:white; border:1px solid #444;">

          <label>How Focused Were You?</label>
          <div class="emoji-slider" id="mentalSlider">
            <span data-val="1">😠</span>
            <span data-val="2">🙁</span>
            <span data-val="3">😐</span>
            <span data-val="4">🙂</span>
            <span data-val="5">😊</span>
          </div>
          <input type="hidden" id="mentalValue" value="3" />

          <label>One-Line Lesson</label>
          <textarea id="lesson" placeholder="What worked? What will you do better next time?" rows="3"></textarea>

          <button type="submit">💾 Save Trade & Return to Dashboard</button>
        </form>
      </section>

      <!-- ANALYSES -->
      <section id="analyses" class="tab">
        <h2>🧠 Your Edge, Visualized</h2>
        <div class="chart-section">
          <h3>🎯 Strategy Performance</h3>
          <canvas id="strategyRadar" height="300"></canvas>
        </div>
        <div class="chart-section">
          <h3>⏰ Best Time to Trade</h3>
          <canvas id="timeHeatmap" height="200"></canvas>
        </div>
        <div class="chart-section">
          <h3>📈 Monthly Equity Curve</h3>
          <canvas id="equityCurve" height="250"></canvas>
        </div>
        <div class="chart-section">
          <h3>🧘 Mental State vs Profit</h3>
          <canvas id="mentalScatter" height="250"></canvas>
        </div>
      </section>

      <!-- DATA -->
      <section id="data" class="tab">
        <h2>💾 Export Monthly Data</h2>
        <button id="exportExcel" class="btn-primary">📊 Export Raw Data (Excel)</button>
        <button id="exportPDF" class="btn-secondary" disabled>📄 Export Visual Report (PDF) — Coming Soon</button>
        <p><small>Exports save to your Downloads folder. No data leaves your machine.</small></p>
      </section>
    </main>
  </div>

  <!-- LIBRARIES -->
  <script src="lib/chart.umd.js"></script>
  <script src="lib/xlsx.full.min.js"></script>
  <script src="lib/FileSaver.js"></script>
  <script src="app.js"></script>
</body>
</html>
